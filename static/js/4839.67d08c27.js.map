{"version":3,"file":"static/js/4839.67d08c27.js","mappings":"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","sources":["webpack://cocogoat-web/./src/views/AchievementScanner/ScanAndExport.vue?9d76","webpack://cocogoat-web/./src/views/AchievementScanner/ScanAndExport.vue","webpack://cocogoat-web/./src/views/AchievementScanner/ScanAndExport.vue?9b59","webpack://cocogoat-web/./src/views/AchievementScanner/ScanAndExport.vue?a957"],"sourcesContent":["import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock } from \"vue\";\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", {\n  style: {\n    \"font-family\": \"genshin\"\n  }\n}, \"椰羊 · \", -1);\n\nconst _hoisted_2 = [\"src\"];\nconst _hoisted_3 = {\n  class: \"model\"\n};\n\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"扫描完成\", -1);\n\nconst _hoisted_5 = {\n  key: 0,\n  class: \"faildResults\"\n};\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = [\"value\"];\nconst _hoisted_8 = {\n  class: \"operations\"\n};\nconst _hoisted_9 = {\n  key: 1\n};\n\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"a\", null, \" | \", -1);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_button = _resolveComponent(\"el-button\");\n\n  const _component_el_tooltip = _resolveComponent(\"el-tooltip\");\n\n  const _component_Layout = _resolveComponent(\"Layout\");\n\n  return _openBlock(), _createBlock(_component_Layout, {\n    \"full-height\": \"\"\n  }, {\n    title: _withCtx(() => [_hoisted_1, _createTextVNode(\"扫描成就并导出到 \" + _toDisplayString(_ctx.to === 'seelie' ? 'SEELIE.me' : 'Paimon.moe'), 1)]),\n    actions: _withCtx(() => [_createVNode(_component_el_tooltip, {\n      content: \"扫描完成之后也还可以切换哦\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        class: \"switch\",\n        type: \"primary\",\n        plain: \"\",\n        onClick: _cache[0] || (_cache[0] = $event => _ctx.$router.replace({ ..._ctx.$route,\n          query: { ..._ctx.$route.query,\n            to: _ctx.to === 'seelie' ? 'paimon-moe' : 'seelie'\n          }\n        }))\n      }, {\n        default: _withCtx(() => [_createTextVNode(\" 切换到 \" + _toDisplayString(_ctx.to === 'seelie' ? 'Paimon.moe' : 'SEELIE.me'), 1)]),\n        _: 1\n      })]),\n      _: 1\n    })]),\n    default: _withCtx(() => [_createElementVNode(\"iframe\", {\n      ref: \"contentFrame\",\n      class: _normalizeClass(_ctx.$style.fr),\n      src: _ctx.frameUrl,\n      frameborder: \"0\"\n    }, null, 10, _hoisted_2), _ctx.finished ? (_openBlock(), _createElementBlock(\"div\", {\n      key: 0,\n      class: _normalizeClass(_ctx.$style.modelBackdrop)\n    }, [_createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _ctx.showFaildImages ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.faildResults, (image, index) => {\n      return _openBlock(), _createElementBlock(\"img\", {\n        key: index,\n        src: image\n      }, null, 8, _hoisted_6);\n    }), 128))])) : (_openBlock(), _createElementBlock(\"textarea\", {\n      key: 1,\n      value: _ctx.to === 'seelie' ? _ctx.exportToSeelie : _ctx.exportToPaiminMoe\n    }, null, 8, _hoisted_7)), _createElementVNode(\"div\", _hoisted_8, [_ctx.faildResults.length > 0 ? (_openBlock(), _createElementBlock(\"span\", {\n      key: 0,\n      onClick: _cache[1] || (_cache[1] = $event => _ctx.showFaildImages = !_ctx.showFaildImages)\n    }, _toDisplayString(_ctx.showFaildImages ? '返回导出结果' : '查看失败项'), 1)) : _createCommentVNode(\"\", true), _ctx.faildResults.length > 0 ? (_openBlock(), _createElementBlock(\"a\", _hoisted_9, \" | \")) : _createCommentVNode(\"\", true), _createElementVNode(\"span\", {\n      class: \"switch\",\n      onClick: _cache[2] || (_cache[2] = $event => _ctx.$router.replace({ ..._ctx.$route,\n        query: { ..._ctx.$route.query,\n          to: _ctx.to === 'seelie' ? 'paimon-moe' : 'seelie'\n        }\n      }))\n    }, \"切换到 \" + _toDisplayString(_ctx.to === 'seelie' ? 'Paimon.moe' : 'SEELIE.me'), 1), _hoisted_10, _createElementVNode(\"span\", {\n      class: \"reset\",\n      onClick: _cache[3] || (_cache[3] = //@ts-ignore\n      (...args) => _ctx.reset && _ctx.reset(...args))\n    }, \"重新开始\")])])], 2)) : _createCommentVNode(\"\", true)]),\n    _: 1\n  });\n}","import \"core-js/modules/es.json.stringify.js\";\nimport { ref, computed, defineComponent, watch } from 'vue';\nimport { useRoute } from 'vue-router';\nimport { getUrl } from '@/router';\nimport achevementsAmos from '@/generated/amos-data/amos/achievements/index';\nexport default defineComponent({\n  setup() {\n    const frameUrl = getUrl('frames.achievement.scan');\n    const showFaildImages = ref(false);\n    const finished = ref(false);\n    const results = ref([]);\n    const faildResults = computed(() => results.value.filter(item => !item.success || !item.done).map(e => {\n      var _e$images;\n\n      return (_e$images = e.images) === null || _e$images === void 0 ? void 0 : _e$images.main;\n    }));\n    const contentFrame = ref(null);\n    const route = useRoute();\n    const to = computed(() => {\n      return route.query.to === 'seelie' ? 'seelie' : 'paimon-moe';\n    });\n    watch(contentFrame, v => {\n      if (!v) return;\n      window.addEventListener('message', ev => {\n        const {\n          app,\n          event,\n          data\n        } = ev.data;\n        if (app !== 'cocogoat.scanner.achievement') return; // console.log(event, data)\n\n        if (event === 'ready') {\n          finished.value = false;\n          return;\n        }\n\n        if (event === 'result') {\n          const {\n            result\n          } = data;\n\n          for (const e of result) {\n            if (!e.success) continue;\n\n            if (e.achievement.preStage && e.achievement.preStage > 0) {\n              const cat = achevementsAmos.find(x => x.id === e.achievement.categoryId);\n\n              if (cat) {\n                const preStage = cat.achievements.find(x => x.id === e.achievement.preStage);\n\n                if (preStage) {\n                  const p = { ...e,\n                    success: true\n                  };\n                  result.push({ ...p,\n                    achievement: { ...preStage,\n                      categoryId: e.achievement.categoryId\n                    }\n                  });\n                }\n              }\n            }\n          }\n\n          results.value = result;\n          finished.value = true;\n          console.log('got result from scanner');\n        }\n      });\n    });\n    const exportToPaiminMoe = computed(() => {\n      const exportArray = results.value.filter(e => e.success && e.date).map(e => {\n        const a = e.achievement;\n        return [a.categoryId, a.id];\n      });\n      return `/* \n* 复制此处所有内容，\n* 在 Paimon.moe 页面按 F12 打开调试器，\n* 选择控制台（Console）\n* 粘贴并回车执行完成导入\n*/\nconst b = ${JSON.stringify(exportArray)};\nconst a = (await localforage.getItem('achievement')) || {};\nb.forEach(c=>{a[c[0]]=a[c[0]]||{};a[c[0]][c[1]]=true})\nawait localforage.setItem('achievement',a);\nlocation.href='/achievement'`;\n    });\n    const exportToSeelie = computed(() => {\n      const exportArray = results.value.filter(e => e.success && e.date).map(e => {\n        const g = e;\n        const a = g.achievement;\n        return [a.id, (g.status + ' ' + g.date).trim()];\n      });\n      return `/* \n* 复制此处所有内容，\n* 在 SEELIE.me 页面按 F12 打开调试器，\n* 选择控制台（Console）\n* 粘贴并回车执行完成导入\n*/\nconst z = ${JSON.stringify(exportArray)};\nconst a = localStorage.account || 'main'\nconst b = JSON.parse(localStorage.getItem(\\`\\${a}-achievements\\`)||'{}')\nz.forEach(c=>{b[c[0]]={done:true,notes:c[1]}})\nlocalStorage.setItem(\\`\\${a}-achievements\\`,JSON.stringify(b))\nlocalStorage.last_update = (new Date()).toISOString()\nlocation.href='/achievements'`;\n    });\n\n    const reset = () => {\n      var _contentFrame$value, _contentFrame$value$c;\n\n      (_contentFrame$value = contentFrame.value) === null || _contentFrame$value === void 0 ? void 0 : (_contentFrame$value$c = _contentFrame$value.contentWindow) === null || _contentFrame$value$c === void 0 ? void 0 : _contentFrame$value$c.postMessage({\n        app: 'cocogoat.scanner.achievement',\n        event: 'reset'\n      }, '*');\n    };\n\n    return {\n      finished,\n      results,\n      exportToPaiminMoe,\n      exportToSeelie,\n      contentFrame,\n      reset,\n      faildResults,\n      showFaildImages,\n      to,\n      frameUrl\n    };\n  }\n\n});","/* unplugin-vue-components disabled */// extracted by mini-css-extract-plugin\nexport default {\"fr\":\"fr-e4616f\",\"modelBackdrop\":\"model-backdrop-c93930\"};","/* unplugin-vue-components disabled */import { render } from \"./ScanAndExport.vue?vue&type=template&id=628295e8&ts=true\"\nimport script from \"./ScanAndExport.vue?vue&type=script&lang=ts\"\nexport * from \"./ScanAndExport.vue?vue&type=script&lang=ts\"\n\nconst cssModules = {}\nimport style0 from \"./ScanAndExport.vue?vue&type=style&index=0&id=628295e8&lang=scss&module=true\"\ncssModules[\"$style\"] = style0\n\nimport exportComponent from \"/home/runner/work/cocogoat/cocogoat/node_modules/.pnpm/vue-loader@17.0.0_webpack@5.73.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__cssModules',cssModules]])\n\nexport default __exports__"],"names":["_hoisted_1","_","style","_hoisted_2","_hoisted_3","class","_hoisted_4","_hoisted_5","key","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","render","_ctx","_cache","$props","$setup","$data","$options","_component_el_button","_component_el_tooltip","_component_Layout","title","to","actions","content","default","type","plain","onClick","$event","$router","replace","$route","query","ref","$style","fr","src","frameUrl","frameborder","finished","modelBackdrop","showFaildImages","faildResults","image","index","value","exportToSeelie","exportToPaiminMoe","length","args","reset","setup","results","filter","item","success","done","map","e","_e$images","images","main","contentFrame","route","v","window","addEventListener","ev","app","event","data","result","achievement","preStage","cat","x","id","categoryId","achievements","find","p","push","console","log","exportArray","date","a","JSON","stringify","g","status","trim","_contentFrame$value","_contentFrame$value$c","contentWindow","postMessage","cssModules","__exports__"],"sourceRoot":""}